function table(e,t,l={}){return new _table(e,t,l)}class _table extends HTMLTableElement{constructor(e,t,l){super(),this._tabletimeout={},0==l?(this.showHead=!1,l={}):this.showHead=_init(l.showHead,!0),setOptions(this,l,{tableAttrib:"border: 1px solid black; ",headAttrib:"background-color: silver; ",bodyAttrib:"",cellAttrib:"",onCellClick:null,canSelect:!1,selectColor:"silver",invalidSelectColor:"#CC6060",invalidColor:"#FF8070",selectedRow:-1,selectedCol:-1}),this.rowSelect=_init(l.rowSelect,!0),this._rowid=l.rowid||[],this._rowvalue=l.rowvalue||[],this._rowvalid=l.rowvalid||[],this.onclick=e=>{if(e.srcElement.cellIndex<0)return;let t=e.srcElement.cellIndex,l=e.srcElement.parentElement.rowIndex;this.select(t,l)},this.doSelect=e=>{if(!this.canSelect)return;let t=e.target,l=t.parentElement.rowIndex,s=t.cellIndex;this.select(s,l)},setAttributes(this,this.tableAttrib),this.buildTable(e,t),l.head&&(this.head=l.head),l.body&&(this.body=l.body),this.select(this.selectedCol,this.selectedRow),l.onSelect&&(this.onSelect=l.onSelect),this.colorize(),appendBase(this)}getrowvalid(e){return arrayvalue(this._rowvalid,e,!0)}setrowvalid(e,t){this._rowvalid[e]=t,clearTimeout(this._tabletimeout),this._tabletimeout=setTimeout((()=>{this.colorize()}),10)}colorize(){for(let e in this.rows){let t=this.rows[e],l=this.getrowvalid(e);for(let e=0;e<t.childElementCount;e++)t.rowIndex!==this.selectedRow||!this.rowSelect&&e!=this.selectedCol?t.cells[e].style.backgroundColor=l?null:this.invalidColor:t.cells[e].style.backgroundColor=l?this.selectColor:this.invalidSelectColor}}buildTable(e,t){let l,s,i,o,r;if(this.innerHTML="",this.showHead)for(i=createAt(this,"THEAD"),l=0;l<e;l++)createAt(i,"th",this.headAttrib).innerHTML="&nbsp";for(o=createAt(this,"TBODY",this.bodyAttrib),s=0;s<t;s++){let t=createAt(o,"TR");for(l=0;l<e;l++)r=createAt(t,"TD",this.cellAttrib),r.innerHTML="&nbsp",r.onclick=this.onCellClick}}put(e,t,l,s){this.buildTable(e,t),l&&(this.head=l),s&&(this.body=s)}cell(e,t){return this.rows[t].cells[e]}colStyle(e,t,l=!1){if(Array.isArray(e)){let t=Math.min(e.length,this.colCnt);for(let s=0;s<t;s++){let t=e[s];for(let e=0;e<this.rows.length;e++)this.rows[e].childNodes[s].style.cssText=t;l&&(this.head[s].style.cssText=t)}}else{for(let l=0;l<this.rows.length;l++)this.rows[l].childNodes[e].style.cssText=t;l&&this.tHead&&(this.tHead.childNodes[e].style.cssText+=t)}}select(e,t){this.selectedRow=t,this.selectedCol=e,this.colorize(),this.onSelect&&this.onSelect(e,t,this)}selectRow(e){this.select(0,e)}get rowCount(){return this.rows?this.rows.length:0}get colCount(){return 0==this.rows.length?0:this.rows[0].childElementCount}get head(){let e=[];for(let t in this.tHead.childNodes){let l=this.tHead.childNodes[t];e.push(l.innerHTML)}return e}set head(e){if(this.showHead){this.tHead.innerHTML="";for(let t in e)createAt(this.tHead,"th",this.headAttrib).innerHTML=e[t]}}get body(){let e,t=[];for(let l=0;l<this.rowCount;l++){e=[];let s=Array.from(this.rows[l].childNodes);for(let t in s){let l=s[t];e.push(l.innerHTML)}t.push(e)}return t}set body(e){if(1==this.colCount)for(let t=0;t<e.length;t++)t<this.rowCount&&(this.cell(0,t).innerHTML=e[t]);else for(let t=0;t<Math.min(e.length,this.rowCount);t++)for(let l=0;l<Math.min(e[t].length,this.colCount);l++)this.cell(l,t).innerHTML=e[t][l]}get rowid(){return this._rowid}set rowid(e){this._rowid=e}get selectedRowid(){return this.selectedRow<0?"":this._rowid[this.selectedRow]}get rowvalue(){return this._rowvalue}set rowvalue(e){this._rowvalue=e}get selectedRowvalue(){return this._rowvalue[this.selectedRow]}get selectedCellvalue(){if(this.selectedCol<0||this.selectedRow<0)return"";return this.cell(this.selectedCol,this.selectedRow).textContent}get selectedCell(){return this.cell(this.selectedCol,this.selectedRow)}}customElements.define("dml-table",_table,{extends:"table"});